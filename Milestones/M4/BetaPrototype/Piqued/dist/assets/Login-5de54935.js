import{S as ue,i as me,s as ce,G as X,C as x,D as ee,e as _,a as k,c as A,b as m,d as U,f as i,m as C,E as te,t as P,g as R,h as L,j as H,A as I,o as re,F as ie,aa as de,Y as pe}from"./index-2614f849.js";import{A as ge}from"./ArrowRight-6373adb4.js";import{H as _e}from"./House-f7c96ce2.js";import{T as se}from"./Textfield-094efca3.js";function ve(n){let t,e,o;return t=new _e({props:{size:"24"}}),{c(){A(t.$$.fragment),e=I("Home")},m(s,r){C(t,s,r),U(s,e,r),o=!0},p:re,i(s){o||(P(t.$$.fragment,s),o=!0)},o(s){R(t.$$.fragment,s),o=!1},d(s){H(t,s),s&&L(e)}}}function he(n){let t;return{c(){t=I("Username")},m(e,o){U(e,t,o)},d(e){e&&L(t)}}}function le(n){let t,e;return{c(){t=_("div"),e=I(n[5]),m(t,"class","validation-error svelte-ojid8v")},m(o,s){U(o,t,s),i(t,e)},p(o,s){s&32&&ie(e,o[5])},d(o){o&&L(t)}}}function be(n){let t;return{c(){t=I("Password")},m(e,o){U(e,t,o)},d(e){e&&L(t)}}}function ne(n){let t,e;return{c(){t=_("div"),e=I(n[6]),m(t,"class","validation-error svelte-ojid8v")},m(o,s){U(o,t,s),i(t,e)},p(o,s){s&64&&ie(e,o[6])},d(o){o&&L(t)}}}function oe(n){let t;return{c(){t=_("div"),t.textContent="There was an issue logging you in.",m(t,"class","validation-error svelte-ojid8v")},m(e,o){U(e,t,o)},d(e){e&&L(t)}}}function we(n){let t,e,o;return t=new ge({props:{size:"24",weight:"bold"}}),{c(){A(t.$$.fragment),e=I("Login")},m(s,r){C(t,s,r),U(s,e,r),o=!0},p:re,i(s){o||(P(t.$$.fragment,s),o=!0)},o(s){R(t.$$.fragment,s),o=!1},d(s){H(t,s),s&&L(e)}}}function $e(n){let t,e,o,s,r,d,$,f,w,z,h,j,b,O,q,y,a,c,S,E,Y,D,Z,B,G,T,J;d=new X({props:{type:"primary",to:"/",icon:"iconLeft",$$slots:{default:[ve]},$$scope:{ctx:n}}});function ae(l){n[12](l)}let K={type:"text",error:!n[3]&&n[2],required:!0,$$slots:{default:[he]},$$scope:{ctx:n}};n[0]!==void 0&&(K.elem=n[0]),b=new se({props:K}),x.push(()=>ee(b,"elem",ae)),b.$on("change",n[8]);let p=!n[3]&&n[2]&&le(n);function fe(l){n[13](l)}let Q={type:"password",error:!n[4]&&V,required:!0,$$slots:{default:[be]},$$scope:{ctx:n}};n[1]!==void 0&&(Q.elem=n[1]),c=new se({props:Q}),x.push(()=>ee(c,"elem",fe)),c.$on("input",n[9]);let g=!n[4]&&V&&ne(n),v=n[7]&&oe();return T=new X({props:{icon:"iconRight",disabled:!(n[3]&&n[4]),$$slots:{default:[we]},$$scope:{ctx:n}}}),T.$on("click",n[10]),{c(){t=_("div"),e=_("div"),e.innerHTML='<img src="../img/grapes.jpg" alt="Grapes" loading="lazy" class="svelte-ojid8v"/>',o=k(),s=_("div"),r=_("div"),A(d.$$.fragment),$=k(),f=_("div"),w=_("h1"),w.textContent="Log In",z=k(),h=_("form"),j=_("div"),A(b.$$.fragment),q=k(),p&&p.c(),y=k(),a=_("div"),A(c.$$.fragment),E=k(),g&&g.c(),Y=k(),D=_("p"),D.innerHTML='Don&#39;t have an account? <a href="/#/signup" class="svelte-ojid8v">Sign Up!</a>',Z=k(),v&&v.c(),B=k(),G=_("div"),A(T.$$.fragment),m(e,"class","splash svelte-ojid8v"),m(r,"id","home-button"),m(r,"class","svelte-ojid8v"),m(w,"class","svelte-ojid8v"),m(j,"class","textfield-container"),m(a,"class","textfield-container"),m(h,"method","post"),m(h,"action","../server/models/users.js"),m(h,"class","svelte-ojid8v"),m(D,"class","svelte-ojid8v"),m(G,"class","login-button svelte-ojid8v"),m(f,"class","login-container svelte-ojid8v"),m(s,"class","prompt svelte-ojid8v"),m(t,"class","page-container svelte-ojid8v")},m(l,u){U(l,t,u),i(t,e),i(t,o),i(t,s),i(s,r),C(d,r,null),i(s,$),i(s,f),i(f,w),i(f,z),i(f,h),i(h,j),C(b,j,null),i(j,q),p&&p.m(j,null),i(h,y),i(h,a),C(c,a,null),i(a,E),g&&g.m(a,null),i(f,Y),i(f,D),i(f,Z),v&&v.m(f,null),i(f,B),i(f,G),C(T,G,null),J=!0},p(l,[u]){const W={};u&16384&&(W.$$scope={dirty:u,ctx:l}),d.$set(W);const M={};u&12&&(M.error=!l[3]&&l[2]),u&16384&&(M.$$scope={dirty:u,ctx:l}),!O&&u&1&&(O=!0,M.elem=l[0],te(()=>O=!1)),b.$set(M),!l[3]&&l[2]?p?p.p(l,u):(p=le(l),p.c(),p.m(j,null)):p&&(p.d(1),p=null);const N={};u&16&&(N.error=!l[4]&&V),u&16384&&(N.$$scope={dirty:u,ctx:l}),!S&&u&2&&(S=!0,N.elem=l[1],te(()=>S=!1)),c.$set(N),!l[4]&&V?g?g.p(l,u):(g=ne(l),g.c(),g.m(a,null)):g&&(g.d(1),g=null),l[7]?v||(v=oe(),v.c(),v.m(f,B)):v&&(v.d(1),v=null);const F={};u&24&&(F.disabled=!(l[3]&&l[4])),u&16384&&(F.$$scope={dirty:u,ctx:l}),T.$set(F)},i(l){J||(P(d.$$.fragment,l),P(b.$$.fragment,l),P(c.$$.fragment,l),P(T.$$.fragment,l),J=!0)},o(l){R(d.$$.fragment,l),R(b.$$.fragment,l),R(c.$$.fragment,l),R(T.$$.fragment,l),J=!1},d(l){l&&L(t),H(d),H(b),p&&p.d(),H(c),g&&g.d(),v&&v.d(),H(T)}}}let V=!1;function je(n,t,e){let{continueRoute:o}=t;console.log(o);let s,r,d=!1,$=!1,f=!1,w="Error",z="Error",h=!1;function j(){e(0,s.value=s.value.trim(),s);const a=/[^A-Za-z0-9]/;let c=s.value.trim()!="",S=!s.value.trim().includes(" "),E=!a.test(s.value);c&&S&&E?e(3,$=!0):c?S?E?(e(3,$=!1),e(5,w="Username is invalid"),e(2,d=!0)):(e(3,$=!1),e(5,w="Username must not contain special characters."),e(2,d=!0)):(e(3,$=!1),e(5,w="Username must not contain spaces."),e(2,d=!0)):(e(3,$=!1),e(5,w="Username cannot be blank."),e(2,d=!0))}function b(){e(1,r.value=r.value.trim(),r),r.value==""?(e(4,f=!1),e(6,z="Password cannot be empty"),e(2,d=!0)):(e(4,f=!0),e(2,d=!1))}function O(){console.log(s.value,r.value),fetch("/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({usernameEmail:s.value,password:r.value})}).then(a=>{a.status==200?a.json().then(c=>{console.log(c),localStorage.setItem("logged","true"),localStorage.setItem("userid",c.userid),fetch("/login/id",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({userid:c.userid})}).then(S=>{S.json().then(E=>{console.log(E),de.set(E.username),localStorage.setItem("username",E.username),pe(o)})})}):e(7,h=!0)})}function q(a){s=a,e(0,s)}function y(a){r=a,e(1,r)}return n.$$set=a=>{"continueRoute"in a&&e(11,o=a.continueRoute)},[s,r,d,$,f,w,z,h,j,b,O,o,q,y]}class Ue extends ue{constructor(t){super(),me(this,t,je,$e,ce,{continueRoute:11})}}export{Ue as default};
